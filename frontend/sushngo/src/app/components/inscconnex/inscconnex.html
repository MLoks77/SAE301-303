<app-navbar></app-navbar>

<!-- front réalisé par Joachim Tocqueville, Maxime Derènes et Témi Kergastel -->
<!-- Nettoyé et optimisé par Antigravity -->

<div class="w-full h-10 mt-14 sm:mt-0 bg-black flex items-center pl-4 gap-1">
    <a routerLink="/accueil"
        class="relative text-gray-200 font-semibold hover:text-white border-b-2 border-transparent hover:border-white transition-colors duration-300">Accueil</a>
    <span class="text-white italic mb-1"> &gt; {{ currentTab === 'connexion' ? 'Connexion' : 'Inscription' }}</span>
</div>

<section id="connexionbg" class="pt-10 min-h-screen">
    <div id="fondform">

        <!-- Onglets -->
        <div class="flex justify-center my-8">
            <div class="Caladea flex rounded-[40px] p-2 gap-2 bg-white shadow-md">
                <button (click)="switchToTab('inscription')" type="button"
                    [class.bg-red-500]="currentTab === 'inscription'" [class.text-white]="currentTab === 'inscription'"
                    [class.bg-white]="currentTab !== 'inscription'" [class.text-black]="currentTab !== 'inscription'"
                    class="transition-all duration-300 cursor-pointer rounded-[40px] w-32 py-3 px-2 font-semibold">
                    Inscription
                </button>
                <button (click)="switchToTab('connexion')" type="button" [class.bg-red-500]="currentTab === 'connexion'"
                    [class.text-white]="currentTab === 'connexion'" [class.bg-white]="currentTab !== 'connexion'"
                    [class.text-black]="currentTab !== 'connexion'"
                    class="transition-all duration-300 cursor-pointer rounded-[40px] w-32 py-3 px-2 font-semibold">
                    Connexion
                </button>
            </div>
        </div>

        <div class="flex flex-col items-center gap-8 justify-center px-4">



            <!-- FORMULAIRE INSCRIPTION -->
            <form *ngIf="currentTab === 'inscription'" #registerForm="ngForm" (ngSubmit)="onSubmitInscription()"
                class="bg-white py-8 px-6 rounded-3xl shadow-2xl max-w-[650px] w-full transition-all duration-500">

                <h2 class="text-2xl font-bold text-center mb-8 text-red-500 border-b border-gray-100 pb-4">
                    Créer un compte
                </h2>

                <!-- Messages d'info -->
                <div *ngIf="successMessage"
                    class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative max-w-[650px] w-full text-center mb-4">
                    {{ successMessage }}
                </div>
                <div *ngIf="errorMessage"
                    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative max-w-[650px] w-full text-center mb-4">
                    {{ errorMessage }}
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Nom <span class="text-red-500">*</span></label>
                        <input name="nom" type="text" placeholder="Nom" [(ngModel)]="registerData.nom" required
                            class="border border-gray-300 rounded-xl py-3 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>
                    <!-- prénom -->
                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Prénom <span class="text-red-500">*</span></label>
                        <input name="prenom" type="text" placeholder="Prénom" [(ngModel)]="registerData.prenom" required
                            class="border border-gray-300 rounded-xl py-3 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>
                    <!-- email -->
                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Email <span class="text-red-500">*</span></label>
                        <input name="email" type="email" placeholder="exemple@email.com"
                            [(ngModel)]="registerData.email" required email
                            class="border border-gray-300 rounded-xl py-3 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>
                    <!-- telephone -->
                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Téléphone <span class="text-red-500">*</span></label>
                        <input name="tel" type="tel" placeholder="..." [(ngModel)]="registerData.tel" required
                            class="border border-gray-300 rounded-xl py-3 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>
                    <!-- adresse -->
                    <div class="flex flex-col md:col-span-2">
                        <label class="mb-1 font-medium">Adresse <span class="text-red-500">*</span></label>
                        <input name="adresse" type="text" placeholder="1 rue du pont" [(ngModel)]="registerData.adresse"
                            required
                            class="border border-gray-300 rounded-xl py-3 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>

                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Mot de passe <span class="text-red-500">*</span><span
                                class="text-gray-300 text-sm"> (8 caractères minimum)</span></label>
                        <div class="relative">
                            <input [type]="showMdpInscr ? 'text' : 'password'" name="password" placeholder="..."
                                [(ngModel)]="registerData.password" required minlength="8"
                                class="border border-gray-300 rounded-xl py-3 px-4 w-full focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                            <button type="button" (click)="togglePassword('mdp_inscr')"
                                class="absolute right-3 top-4 text-gray-400 hover:text-red-500 transition-colors">
                                <svg *ngIf="!showMdpInscr" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
                                    <path
                                        d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
                                </svg>
                                <svg *ngIf="showMdpInscr" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z" />
                                    <path
                                        d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829" />
                                    <path
                                        d="M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Confirmation <span class="text-red-500">*</span></label>
                        <div class="relative">
                            <input [type]="showConfirmMdp ? 'text' : 'password'" name="confirmPassword"
                                placeholder="..." [(ngModel)]="registerData.confirmPassword" required
                                class="border border-gray-300 rounded-xl py-3 px-4 w-full focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                            <button type="button" (click)="togglePassword('confirm_mdp')"
                                class="absolute right-3 top-4 text-gray-400 hover:text-red-500 transition-colors">
                                <svg *ngIf="!showConfirmMdp" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
                                    <path
                                        d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
                                </svg>
                                <svg *ngIf="showConfirmMdp" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z" />
                                    <path
                                        d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829" />
                                    <path
                                        d="M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="md:col-span-2 flex flex-col gap-3">
                        <div class="flex items-center gap-2 cursor-pointer">
                            <input id="etudiant" name="statut_etud" type="checkbox"
                                [(ngModel)]="registerData.statut_etud" class="w-5 h-5 accent-red-500 cursor-pointer" />
                            <label for="etudiant" class="cursor-pointer">Je suis étudiant</label>
                        </div>
                        <div class="flex items-center gap-2 cursor-pointer">
                            <input id="cgu" name="cgu" type="checkbox" [(ngModel)]="registerData.cgu" required
                                class="w-5 h-5 accent-red-500 cursor-pointer" />
                            <label for="cgu" class="cursor-pointer text-sm">
                                J'accepte les <a routerLink="/mentions-legales"
                                    class="text-blue-600 hover:underline">Conditions Générales d'Utilisation</a> *
                            </label>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col items-center mt-10 gap-4">
                    <button type="submit" [disabled]="!registerForm.valid || isLoading"
                        class="cursor-pointer rounded-2xl py-4 w-56 bg-red-500 hover:bg-red-600 disabled:bg-gray-400 transition-all text-white font-bold text-lg shadow-lg hover:shadow-xl">
                        {{ isLoading ? 'Création...' : "S'inscrire" }}
                    </button>
                    <span class="text-xs text-gray-400">* Champs obligatoires</span>
                </div>
            </form>

            <!-- FORMULAIRE CONNEXION -->
            <form *ngIf="currentTab === 'connexion'" #loginForm="ngForm" (ngSubmit)="onSubmitConnexion()"
                class="bg-white py-10 px-8 rounded-3xl shadow-2xl max-w-[450px] w-full transition-all duration-500">

                <h2 class="text-2xl font-bold text-center mb-8 text-red-500 border-b border-gray-100 pb-4">
                    Connexion
                </h2>

                <!-- Messages d'info -->
                <div *ngIf="successMessage"
                    class="bg-green-100 text-green-700 px-4 py-5 rounded relative max-w-[650px] w-full text-center mb-4">
                    {{ successMessage }}
                </div>
                <div *ngIf="errorMessage"
                    class="bg-red-100 text-red-700 px-4 py-5 rounded relative max-w-[650px] w-full text-center mb-4">
                    {{ errorMessage }}
                </div>

                <div class="flex flex-col gap-6">
                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Email <span class="text-red-500">*</span></label>
                        <input name="email" type="email" placeholder="Votre email" [(ngModel)]="loginData.email"
                            required
                            class="border border-gray-300 rounded-xl py-4 px-4 focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                    </div>

                    <div class="flex flex-col">
                        <label class="mb-1 font-medium">Mot de passe <span class="text-red-500">*</span></label>
                        <div class="relative">
                            <input [type]="showMdpConnex ? 'text' : 'password'" name="password"
                                placeholder="Votre mot de passe" [(ngModel)]="loginData.password" required
                                class="border border-gray-300 rounded-xl py-4 px-4 w-full focus:ring-2 focus:ring-red-500 outline-none transition-all" />
                            <button type="button" (click)="togglePassword('mdp_connex')"
                                class="absolute right-4 top-5 text-gray-400 hover:text-red-500 transition-colors">
                                <svg *ngIf="!showMdpConnex" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
                                    <path
                                        d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
                                </svg>
                                <svg *ngIf="showMdpConnex" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                    fill="currentColor" viewBox="0 0 16 16">
                                    <path
                                        d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z" />
                                    <path
                                        d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829" />
                                    <path
                                        d="M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="text-right">
                        <a routerLink="/mot-de-passe-oublie" class="text-sm text-blue-600 hover:underline">Mot de passe
                            oublié ?</a>
                    </div>
                </div>

                <div class="flex justify-center mt-10">
                    <button type="submit" [disabled]="!loginForm.valid || isLoading"
                        class="rounded-2xl py-4 w-full bg-red-500 hover:bg-red-600 disabled:bg-gray-400 transition-all cursor-pointer text-white font-bold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 active:translate-y-0">
                        {{ isLoading ? 'Connexion...' : 'Se connecter' }}
                    </button>
                </div>
            </form>

        </div>

    </div>
</section>

<app-footer></app-footer>