<app-navbar></app-navbar>
<!-- Sebastian Chisiu -->
<div class="w-full h-10 mt-14 sm:mt-0 bg-black flex items-center pl-4 gap-1">
  <a routerLink="/accueil"
    class="relative text-gray-200 font-semibold hover:text-white border-b-2 border-transparent hover:border-white transition-colors duration-300">Accueil</a>
  <span class="text-white italic mb-1"> &gt; Notre carte</span>
</div>
<div class="w-[90%] h-[360px] border-3 border-black mx-auto mt-5 overflow-hidden relative">
  <div id="carousel-slider" class="h-full w-full flex transition-transform duration-700 ease-in-out"
    [style.transform]="'translateX(-' + (activeCarrouselIndex * 100) + '%)'">
    <div *ngFor="let slide of carrousel" class="min-w-full h-full bg-white">
      <a [routerLink]="slide.link" class="block w-full h-full">
        <img [src]="slide.image" alt="carousel image" class="w-full h-full object-cover" />
      </a>
    </div>
  </div>
  <!-- Dots navigation -->
  <div class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-2">
    <button *ngFor="let slide of carrousel; let i = index" class="w-2.5 h-2.5 rounded-full"
      [ngClass]="{'bg-black': i === activeCarrouselIndex, 'bg-gray-300': i !== activeCarrouselIndex}"
      (click)="setCarrouselIndex(i)">
    </button>
  </div>
</div>

<div class="w-[90%] mx-auto mt-5">
  <div class="flex items-center justify-between px-2">
    <span class="font-semibold uppercase text-[13px] tracking-wider relative z-10">BOXES</span>
    <!--tracking wider = espacement entre les lettres -->
    <div class="relative">
      <button (click)="toggleMenuFiltres()" class="flex items-center gap-2">
        Filtres
        <svg xmlns="http://www.w3.org/2000/svg" class="w-[20px] h-[20px]" fill="none" viewBox="0 0 24 24"
          stroke="currentcolor">
          <circle cx="12" cy="12" r="10" stroke-width="2" />
          <path stroke-width="2" d="M6 9h12M7 12h10M8 15h8" stroke-linecap="round" />
          <!-- M = Move to 6(x) 9(y) h12(ligne horizontale de 12px) etc-->
        </svg>
      </button>

      <!-- Menu déroulant des filtres -->
      <div *ngIf="afficherFiltres"
        class="absolute right-0 top-10 w-64 bg-white shadow-xl rounded-xl border border-gray-100 z-50 p-4">
        <h4 class="font-bold text-sm mb-3">Ingrédients</h4>
        <div class="max-h-60 overflow-y-auto space-y-2">
          <div *ngFor="let filtre of filtresDisponibles" class="flex items-center gap-2">
            <input type="checkbox" [id]="filtre" (change)="gererFiltre(filtre)"
              [checked]="filtresSelectionnes.includes(filtre)"
              class="rounded border-gray-300 text-black focus:ring-black">
            <label [for]="filtre" class="text-sm cursor-pointer select-none">{{filtre}}</label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="relative mt-px">
    <!-- si la div parent a un position autre que static (par défaut) (donc relative , absolute, sticky etc) l'élément enfant avec absolute prendra comme bord gauche-top-droit-bottom les bords de la div parent et pas de la page entiere-->
    <div class="border-b border-black w-full absolute left-0 top-1/2 transform -translate-y-1/2"></div>
    <div class="absolute right-2 top-0 h-full bg-white" style="width:65px"></div>
  </div>
</div>

<div class="w-[90%] mx-auto mt-12 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-6 gap-y-10 mb-10">
  <div *ngFor="let box of listeFiltree" (click)="ouvrirModal(box)"
    class="bg-[#F8F8F8] p-4 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 relative group border border-transparent hover:border-gray-200 cursor-pointer">
    <div class="absolute top-3 right-3 text-black hover:bg-gray-200 rounded-full p-1 transition-colors z-10">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="1"></circle>
        <circle cx="19" cy="12" r="1"></circle>
        <circle cx="5" cy="12" r="1"></circle>
      </svg>
    </div>

    <!-- Image -->
    <div
      class="w-full aspect-square flex items-center justify-center mb-4 transition-transform duration-300 group-hover:scale-105">
      <img [src]="box.image" [alt]="box.nom" class="w-full h-full object-contain drop-shadow-lg" />
    </div>

    <!-- Données de la box -->
    <div class="flex flex-col">
      <h3 class="font-bold text-lg text-black mb-1 line-clamp-1">{{box.nom}}</h3>
      <p class="text-gray-500 text-sm mb-4 line-clamp-2">{{box.description}}</p>
      <div class="text-right">
        <span class="font-bold text-xl text-black">{{box.prix}}</span>
      </div>
    </div>
  </div>
</div>


<!-- MODAL / OVERLAY PRODUIT -->
<div *ngIf="boxSelectionnee" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl w-full h-full overflow-y-auto relative p-6">
    <!-- Bouton Fermer overlay-->
    <button (click)="fermerModal()"
      class="absolute top-4 right-4 text-black hover:bg-gray-100 p-2 rounded-full cursor-pointer">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>

    <!-- Grid Overlay pour la fiche produit -->
    <div class="grid grid-cols-2 grid-rows-2 gap-4">
      <!-- Image du produit overlay -->
      <div>
        <div class="w-full border-2 border-black">
          <img [src]="boxSelectionnee.image" [alt]="boxSelectionnee.nom" class="w-full h-full object-cover rounded-xl">
        </div>
      </div>

      <!-- Description du produit overlay-->
      <div class="flex flex-col gap-4 mt-7">
        <div class="flex items-start justify-between w-full">
          <div class="flex items-center gap-3">
            <h2 class="text-2xl font-bold">{{boxSelectionnee.nom}}</h2>
            <span class="text-md px-2 text-green-600 mt-1">En stock</span>
            <!--Pour afficher en stock ou hors stock , mais on a pas l'info dans la BDD donc par défaut je met en Stock :
            <span class="text-md px-2 rounded-xl"  [ngClass]="boxSelectionnee.enStock ? 'text-green-600' : 'text-red-600'">
              {{boxSelectionnee.enStock ? 'En Stock' : 'Hors Stock'}}</span> 
            -->
          </div>
          <div class="flex items-center gap-3 mt-1">
            <label for="quantité">Quantité</label>
            <input type="number" id="quantité" name="quantité" min="1" max="10" [(ngModel)]="quantiteSelectionnee"
              class="w-[50px] bg-gray-200 border border-gray-800 pl-2">
          </div>
          <span class="text-xl font-bold text-black py-1">{{boxSelectionnee.prix}}€</span>
        </div>
        <div>
          <h4 class="font-bold mb-2">Saveurs :</h4>
          <ul class="list-disc pl-5">
            <li *ngFor="let saveur of boxSelectionnee.saveursListe">
              {{ saveur }}
            </li>
          </ul>
        </div>
        <div class="flex items-center justify-between w-full mt-4">
          <h4 class="font-semibold py-2 text-xl">Prix Total : <span class="font-bold"> {{ getPrixTotal()}}€</span></h4>

          <div class="flex gap-4 text-center">
            <div class="flex flex-col items-center gap-1 w-20">
              <div class="w-12 h-12 rounded flex items-center justify-center text-black">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
              </div>
              <span class="text-[10px] leading-tight">Paiement Sécurisé</span>
            </div>
            <div class="flex flex-col items-center gap-1 w-20">
              <div class="w-12 h-12 rounded flex items-center justify-center text-black">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
                </svg>
              </div>
              <span class="text-[10px] leading-tight">Livraison rapide</span>
            </div>
            <div class="flex flex-col items-center gap-1 w-20">
              <div class="w-12 h-12 rounded flex items-center justify-center text-black">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3" />
                </svg>
              </div>
              <span class="text-[10px] leading-tight">Tarifs étudiants</span>
            </div>
          </div>
        </div>
        <button
          class="w-full bg-[#F64F4F] text-white font-bold py-2 rounded-md hover:bg-gray-500 transition mb-3">Ajouter au
          panier</button>
        <div class="grid grid-cols-7 grid-rows-1 bg-red-300">
          <div>1</div>
          <div>2</div>
          <div>3</div>
          <div>4</div>
          <div>5</div>
          <div>6</div>
          <div>7</div>
        </div>
      </div>


      <div class=" col-span-2 bg-red-500">Description ici
      </div>
    </div>
    <!--
      <div class="mb-4">
        <span class="text-xs text-gray-400 uppercase tracking-widest">Saveurs</span>
        <p class="text-sm font-medium">{{boxSelectionnee.saveurs}}</p>
      </div>

      Exemples de boutons (pas encore fonctionnels)
    <button class="w-full bg-black text-white font-bold py-3 rounded-full hover:bg-gray-800 transition mb-3">
      Ajouter au panier
    </button>
  </div> 
  </div>-->

  </div>
</div>

<app-footer></app-footer>